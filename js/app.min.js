"use strict";var UTIL=function(){let e={capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},round:function(e){return Math.round(100*(e+Number.EPSILON))/100}};return e}(),LANG=function(){let e={data:null,_current:null,keys:["es","bu","de","en","fr","gr","hu","it","nl","pt","ro","ru","tr"],init:function(t){let n={lang:"en"};t=Object.assign({},n,t);let i="/lang/"+t.lang+".js",r=document.createElement("script");r.onload=function(){e.data=LANG_DATA,APP.init()},r.src=i,document.head.appendChild(r),e._current=t.lang},current:function(){return e._current},get:function(t){return e.data[t]}};return e}(),API=function(){let e={};return e=function(e,t){function n(e){return new Promise(t=>e.json().then(n=>t({status:e.status,ok:e.ok,json:n})))}let i,r=!1;if(t instanceof FormData)i=t;else{r=!0;let e={};t=Object.assign({},e,t),i=JSON.stringify(t)}let c={method:"post",body:i};return r&&(c.headers={"content-type":"application/json"}),new Promise((t,i)=>{fetch(e,c).then(e=>(e.redirected&&(location.href=e.url),e)).then(n).then(e=>e.ok?t(e.json.content):i(e.json)).catch(e=>i({networkError:e.message}))})},e}(),APP=function(){let e,t,n={debug:!0,currentMachine:null,currentConcime:null,concimeTypeList:["fertilizzanti","semi","lumachicida"]};return n.init=function(){e=document.querySelector(".main"),t=document.querySelector(".menu"),n.debug&&(n.currentMachine="apollo-galileo",n.currentConcime="mesurol-pro",n.currentWorkingWidth=9,n.currentWorkingSpeed=6,n.currentWorkingQuantity=1),n.routes=[{regex:"^$",template:"index",callback:n.initIndex},{regex:"^set-machine/?$",template:"set-machine",callback:n.initSetMachine},{regex:"^set-concime/?$",template:"set-concime",callback:n.initSetConcime},{regex:"^set-params/?$",template:"set-params",callback:n.initSetWorkingParameters},{regex:"^result/?$",template:"result",callback:n.initResult}],window.addEventListener("hashchange",APP.onHashChange,!1),APP.onHashChange(),n.initMenu()},n.onHashChange=function(){n.hash=location.hash.substring(1);let t=!0;for(const r of n.routes){let c=new RegExp(r.regex,"i"),a=n.hash.match(c);if(a){let c=a.groups,o=document.querySelector(`template[data-section=${r.template}]`);if(o){n.currentTemplate&&(n.previousTemplate=n.currentTemplate),n.currentTemplate=r.template;let a=o.content.cloneNode(!0);function i(){function n(){document.body.classList.add("animate")}let i=null;i="function"==typeof r.callback?r.callback(a,c):a,i&&(e.innerHTML="",e.append(i)),t?window.setTimeout(function(){n()},300):n()}t&&(document.body.classList.remove("animate"),n.previousTemplate?setTimeout(function(){i()},300):i())}break}}},n.changeContent=function(e){location.hash=e},n.initIndex=function(t){return console.log("test"),e.innerHTML="",e.append(t),null},n.initMenu=function(){let e=t.querySelector(".menu-saved"),n=t.querySelector(".menu-lang"),i=t.querySelector(".menu-unit"),r=t.querySelector(".menu-who"),c=t.querySelector(".menu-contact");e.innerHTML=LANG.get("menu-saved"),n.innerHTML=LANG.get("menu-lang"),i.innerHTML=LANG.get("menu-unit"),r.innerHTML=LANG.get("menu-who"),c.innerHTML=LANG.get("menu-contact")},n.menuOpen=function(){t.classList.add("is-visible")},n.menuClose=function(){t.classList.remove("is-visible")},n.initSetMachine=function(t){let i=t.querySelector(".machine-list"),r=n.getMachine(),c="";for(const e of Object.keys(r)){let t=r[e];c+=`<div class="machine">\n                <div class="machine-img">\n                    <img src="/img/machine/${e}.jpg" alt="${t.name}" />\n                    <button onclick="APP.setMachine('${e}');">${LANG.get("select")}</button>\n                </div>\n                ${t.name}\n            </div>`}return i.innerHTML=c,e.innerHTML=n.getStepHtml("machine"),e.append(t),null},n.getMachine=function(e){return e?MACHINE_DATA[e]:MACHINE_DATA},n.setMachine=function(e){e&&(n.currentMachine=e,n.changeContent("set-concime"))},n.getStepHtml=function(e){let t="",n="selected";return t=`<div class="step-list">\n            <div class="step ${"machine"===e?n:""}" onclick="APP.changeContent('set-machine');">${LANG.get("step-machine")}</div>\n            <div class="step ${"concime"===e?n:""}" onclick="APP.changeContent('set-concime');">${LANG.get("step-concime")}</div>\n            <div class="step ${"params"===e?n:""}" onclick="APP.changeContent('set-params');">${LANG.get("step-params")}</div>\n        </div>`,t},n.showMachine=function(e){n.getMachine(e);let t=`<div class="machine">\n            <div class="machine-img">${machineImg}</div>\n            <div class="machine-title">${machineTitle}</div>\n            <div class="machine-subtitle">${machineSubtitle}</div>\n            <div class="machine-desc">${machineDesc}</div>\n        </div>`,i=document.createElement("div");i.innerHTML=t,document.body.appendChild(i),document.body.classList.add("alert-overflow")},n.initSetConcime=function(t){let i=t.querySelector(".concime-type-list"),r=t.querySelector(".concime-list"),c=n.getConcime(),a="";for(const e of n.concimeTypeList){let t=UTIL.capitalizeFirstLetter(e);a+=`<div class="concime-type">\n                <div class="concime-type-img">\n                    <img src="/img/concime-type/${e}.png" alt="${t}" />\n                    <button onclick="APP.setConcimeType('${e}');">${LANG.get("select")}</button>\n                </div>\n                ${t}\n            </div>`}i.innerHTML=a,a="";for(const e of Object.keys(c)){let t=c[e];a+=`<div class="concime" data-concime-type="${t.type}" hidden>\n                <div class="concime-img">\n                    <img src="/img/concime/${e}.png" alt="${t.name}" />\n                    <button onclick="APP.setConcime('${e}');">${LANG.get("select")}</button>\n                </div>\n                ${t.name}\n            </div>`}return r.innerHTML=a,e.innerHTML=n.getStepHtml("concime"),e.append(t),null},n.getConcime=function(e){return e?CONCIME_DATA[e]:CONCIME_DATA},n.setConcimeType=function(e){if(!e)return;let t=document.querySelectorAll(".concime");for(const n of t)n.getAttribute("data-concime-type")===e?n.removeAttribute("hidden"):n.setAttribute("hidden","")},n.setConcime=function(e){e&&(n.currentConcime=e,n.changeContent("set-params"))},n.initSetWorkingParameters=function(t){let i=n.getMachine(n.currentMachine),r=t.querySelector(".optional-width");if(i.widthOpt){r.removeAttribute("hidden");let e=t.querySelector(".optional-width-label");e.innerHTML=LANG.get("working-optional-kit")}else r.setAttribute("hidden","");let c={width:{min:i.widthMin,max:n.getMaxWidth(n.currentMachine,n.currentConcime)},speed:{min:6,max:20},quantity:{min:3,max:1e3}};for(const e of Object.keys(c)){let n=c[e],i=t.querySelector(".parameter-"+e+" .parameter-title"),r=t.querySelector(".parameter-"+e+" .parameter-slider input"),a=t.querySelector(".parameter-"+e+" .parameter-max"),o=t.querySelector(".parameter-"+e+" .parameter-min");i.innerHTML=UTIL.capitalizeFirstLetter(e),o.innerHTML=n.min+"m",r.setAttribute("min",n.min),a.innerHTML=n.max+"m",r.setAttribute("max",n.max)}return e.innerHTML=n.getStepHtml("params"),e.append(t),null},n.refreshCheckLabel=function(e){let t=e.closest(".parameter").querySelector(".parameter-text input");console.log(e.value),t.value=e.value},n.refreshMaxWorkingWidth=function(){n.getMachine(n.currentMachine);let e=document.querySelector(".optional-width-checkbox"),t=document.querySelector(".parameter-width .parameter-max"),i=document.querySelector(".parameter-width .parameter-slider input"),r=n.getMaxWidth(n.currentMachine,n.currentConcime,e.checked);t.innerHTML=r+"m",i.setAttribute("max",r),n.refreshCheckLabel(i)},n.paramsReset=function(){},n.paramsCompute=function(){n.currentWorkingWidth=document.querySelector(".parameter-width .parameter-slider input").value,n.currentWorkingSpeed=document.querySelector(".parameter-speed .parameter-slider input").value,n.currentWorkingQuantity=document.querySelector(".parameter-quantity .parameter-slider input").value,n.changeContent("result")},n.getMaxWidth=function(e,t,i=!1){let r=n.getMachine(e),c=n.getConcime(t),a=Math.min(r.widthMax,c.spreadingLimit),o=i?r.widthOptException:r.widthException;return o&&t in o&&(a=Math.min(a,o[t])),a},n.getOpening=function(e,t){const i=0,r=1;n.getMachine(e),n.getConcime(t);let c=n.currentWorkingQuantity*n.currentWorkingWidth*n.currentWorkingSpeed/600;c=UTIL.round(c);let a=null,o=CURVE_DATA[t],u=Number.MAX_VALUE,l=null;for(let e=0;e<o.length&&(l=Math.abs(o[e][r]-c),l<u);e++)u=l,a=o[e][i];return{opening:a,kgMin:c}},n.initResult=function(t){function i(e,t){let n=`<div class="result">\n                <div class="result-text">${e}</div>\n                <div class="result-value">${t}</div>\n            </div>`;return n}let r=n.getMachine(n.currentMachine),c=n.getConcime(n.currentConcime),a=t.querySelector(".result-list"),o="",u=n.getOpening(n.currentMachine,n.currentConcime);return o+=i("openening",u.opening),o+=i("kg/min",u.kgMin),o+=i("spreader",r.name),o+=i("discs height",""),o+=i("pto speed",""),o+=i("family",c.type),o+=i("product",c.name),o+=i("form",c.shape),o+=i("weight",c.weight),o+=i("working width",n.currentWorkingWidth),o+=i("speed",n.currentWorkingSpeed),o+=i("quantity",n.currentWorkingQuantity),a.innerHTML=o,e.innerHTML="",e.append(t),null},n.saveResult=function(){},n.getResultList=function(){},n}();document.addEventListener("DOMContentLoaded",function(){LANG.init()});