"use strict";var UTIL=function(){let e={capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},round:function(e){return Math.round(100*(e+Number.EPSILON))/100}};return e}(),LANG=function(){let e={data:null,_current:null,keys:["es","bu","de","en","fr","gr","hu","it","nl","pt","ro","ru","tr"],init:function(t){let n={lang:"en"};t=Object.assign({},n,t);let i="/lang/"+t.lang+".js",c=document.createElement("script");c.onload=function(){e.data=LANG_DATA,APP.init()},c.src=i,document.head.appendChild(c),e._current=t.lang},current:function(){return e._current},get:function(t){return e.data[t]}};return e}(),API=function(){let e={};return e=function(e,t){function n(e){return new Promise(t=>e.json().then(n=>t({status:e.status,ok:e.ok,json:n})))}let i,c=!1;if(t instanceof FormData)i=t;else{c=!0;let e={};t=Object.assign({},e,t),i=JSON.stringify(t)}let a={method:"post",body:i};return c&&(a.headers={"content-type":"application/json"}),new Promise((t,i)=>{fetch(e,a).then(e=>(e.redirected&&(location.href=e.url),e)).then(n).then(e=>e.ok?t(e.json.content):i(e.json)).catch(e=>i({networkError:e.message}))})},e}(),APP=function(){let e,t,n={debug:!0,currentMachine:null,currentConcime:null,concimeTypeList:["fertilizzanti","semi","lumachicida"]};return n.init=function(){e=document.querySelector(".main"),t=document.querySelector(".menu"),n.debug&&(n.currentMachine="david-compact",n.currentConcime="mesurol-pro",n.currentWorkingWidth=9,n.currentWorkingSpeed=6,n.currentWorkingQuantity=1),n.routes=[{regex:"^$",template:"index",callback:n.initIndex},{regex:"^set-machine/?$",template:"set-machine",callback:n.initSetMachine},{regex:"^machine/(?<id>[^/]*)/?$",template:"machine-detail",callback:n.initMachine,animate:!1},{regex:"^set-concime/?$",template:"set-concime",callback:n.initSetConcime},{regex:"^set-params/?$",template:"set-params",callback:n.initSetWorkingParameters},{regex:"^result/?$",template:"result",callback:n.initResult},{regex:"^flow-factor/?$",template:"flow-factor",callback:n.initFlowFactor}],window.addEventListener("hashchange",APP.onHashChange,!1),APP.onHashChange(),n.initMenu()},n.onHashChange=function(){n.hash=location.hash.substring(1);let t=!0;for(const c of n.routes){let a=new RegExp(c.regex,"i"),s=n.hash.match(a);if(s){let a=s.groups,r=document.querySelector(`template[data-section=${c.template}]`);if(r){n.currentTemplate&&(n.previousTemplate=n.currentTemplate),n.currentTemplate=c.template,n.currentTemplate;let s=r.content.cloneNode(!0);function i(){function n(){document.body.classList.add("animate")}let i=null;i="function"==typeof c.callback?c.callback(s,a):s,i&&(e.innerHTML="",e.append(i)),t?window.setTimeout(function(){n()},300):n()}t&&(document.body.classList.remove("animate"),n.previousTemplate?setTimeout(function(){i()},300):i())}break}}},n.changeContent=function(e){location.hash=e},n.initIndex=function(t){return e.innerHTML="",e.append(t),null},n.initMenu=function(){let e=t.querySelector(".menu-saved"),n=t.querySelector(".menu-lang"),i=t.querySelector(".menu-unit"),c=t.querySelector(".menu-who"),a=t.querySelector(".menu-contact");e.innerHTML=LANG.get("menu-saved"),n.innerHTML=LANG.get("menu-lang"),i.innerHTML=LANG.get("menu-unit"),c.innerHTML=LANG.get("menu-who"),a.innerHTML=LANG.get("menu-contact")},n.menuOpen=function(){t.classList.add("is-visible")},n.menuClose=function(){t.classList.remove("is-visible")},n.initSetMachine=function(t){let i=t.querySelector(".machine-list"),c=n.getMachine(),a="";for(const e of Object.keys(c)){let t=c[e];a+=`<button class="machine" onclick="APP.setMachine('${e}');">\n                <div class="machine-img">\n                    <img src="/img/machine/${e}.jpg" alt="${t.name}" />\n                </div>\n                <div class="machine-title">\n                    ${t.name}\n                    <small>${t.subtitle}</small>\n                </div>\n                <div class="machine-info" onclick="event.stopPropagation();APP.showMachine('${e}');">\n                    <img src="/img/icons/info-white.svg" />\n                </div>\n            </button>`}return i.innerHTML=a,e.innerHTML=n.getStepHtml("machine"),e.append(t),null},n.getMachine=function(e){return e?MACHINE_DATA[e]:MACHINE_DATA},n.setMachine=function(e){e&&(n.currentMachine=e,n.refreshStepList(),n.changeContent("set-concime"))},n.getStepHtml=function(e){let t="",i="is-selected",c=!n.currentConcime||!n.currentMachine;return t=`<div class="step-list">\n            <button class="step ${"machine"===e?i:""}" data-step="machine" onclick="APP.changeContent('set-machine');">\n                <div class="step-number">1</div>\n                <div class="step-title">${LANG.get("step-machine")}</div>\n                <div class="step-subtitle">Set your spreader</div>\n            </button>\n            <button class="step ${"concime"===e?i:""}" data-step="concime" onclick="APP.changeContent('set-concime');">\n                <div class="step-number">2</div>\n                <div class="step-title">${LANG.get("step-concime")}</div>\n                <div class="step-subtitle">Set the product</div>\n            </button>\n            <button class="step ${c?"is-disabled":""} ${"params"===e?i:""}" data-step="params" onclick="APP.changeContent('set-params');">\n                <div class="step-number">3</div>\n                <div class="step-title">${LANG.get("step-params")}</div>\n                <div class="step-subtitle">Set working parameters</div>\n            </button>\n            <button class="step ${c?"is-disabled":""} ${"result"===e?i:""}" data-step="result" onclick="APP.changeContent('result');">\n                <div class="step-number">4</div>\n                <div class="step-title">RESULT</div>\n                <div class="step-subtitle"> </div>\n            </button>\n        </div>`,t},n.initMachine=function(t,i){let c=n.getMachine(i.id),a="machine-desc",s=`<div class="machine-detail">\n            <button class="machine-close" onclick="APP.hideMachine();">\n                <img src="/img/icons/close.svg" alt="">\n            </button>\n            <div class="machine-img">\n                <img src="/img/machine/${i.id}.jpg" alt="${c.name}" />\n            </div>\n            <div class="machine-title">\n                ${c.name}\n            </div>\n            <div class="machine-subtitle">\n                ${c.subtitle}\n                </div>\n            <div class="machine-desc">${a}</div>\n        </div>`,r=document.createElement("div");return r.classList.add("machine-detail-container","is-visible"),r.innerHTML=s,e.append(r),null},n.showMachine=function(t){let i=n.getMachine(t),c=LANG.get(t),a=`<div class="machine-detail">\n            <div class="machine-title">\n                ${i.name}\n                <small>${i.subtitle}</small>\n\n                <button class="machine-close" onclick="APP.hideMachine();">\n                    <img src="/img/icons/close-white.svg" alt="">\n                </button>\n            </div>\n            <div class="machine-scroll">\n                <div class="machine-img">\n                    <img src="/img/machine/${t}.jpg" alt="${i.name}" />\n                    <div class="machine-subtitle">\n                        ${c.subtitle}\n                    </div>\n                </div>\n\n                <div class="machine-desc">\n                    <b>${c.shortDescription}</b>\n                    ${c.description}\n                </div>\n            </div>\n        </div>`,s=document.createElement("div");return s.classList.add("machine-detail-container"),s.innerHTML=a,e.append(s),setTimeout(()=>{document.querySelector(".machine-detail-container").classList.add("is-visible")},300),null},n.hideMachine=function(){n.previousTemplate;let e=document.querySelector(".machine-detail-container");e&&(e.classList.remove("is-visible"),setTimeout(()=>{e.remove()},300))},n.initSetConcime=function(t){let i=t.querySelector(".concime-type-list"),c=t.querySelector(".concime-list"),a=n.getConcime(),s="";for(const e of n.concimeTypeList){let t=UTIL.capitalizeFirstLetter(e);s+=`<button class="concime-type" onclick="APP.setConcimeType(this, '${e}');">\n                <div class="concime-type-img">\n                    <img src="/img/concime-type/${e}.jpg" alt="${t}" />\n                </div>\n                ${t}\n            </button>`}i.innerHTML=s,s="";for(const e of Object.keys(a)){let t=a[e];s+=`<div class="concime" data-concime-type="${t.type}" onclick="APP.setConcime('${e}');">\n                <div class="concime-img">\n                    <img src="/img/concime/${e}.png" alt="${t.name}" />\n                </div>\n                <div class="concime-title">${t.name}</div>\n                <div class="concime-info" onclick="event.stopPropagation();APP.showConcime('${e}');">\n                    <img src="/img/icons/info.svg" />\n                </div>\n            </div>`}return c.innerHTML=s,e.innerHTML=n.getStepHtml("concime"),e.append(t),null},n.getConcime=function(e){return e?CONCIME_DATA[e]:CONCIME_DATA},n.setConcimeType=function(e,t){let n=document.querySelector(".concime-type.is-selected");if(n&&n.classList.remove("is-selected"),e.classList.add("is-selected"),!t)return;let i=document.querySelectorAll(".concime");for(const e of i)e.getAttribute("data-concime-type")===t?e.removeAttribute("hidden"):e.setAttribute("hidden","")},n.setConcime=function(e){e&&(n.currentConcime=e,n.refreshStepList(),n.changeContent("set-params"))},n.refreshStepList=function(){if(n.currentConcime&&n.currentMachine){let e=document.querySelector(".step[data-step=params]");e.classList.remove("is-disabled")}},n.showConcime=function(t){let i=n.getConcime(t),c=(LANG.get(t),[{category:"Information"},{name:"Family",value:i.category||""},{name:"Country",value:i.country||""},{name:"Form",value:i.producer||""},{name:"Manufacturer",value:i.producer||""},{name:"KG/DM3",value:i.weight||""},{category:"Fractionation"},{name:"",value:""},{name:"",value:""},{category:"Chemical composition"},{name:"",value:i.chemicalComposition_it||""}]),a="";for(const e of c)e.category?a+=`<div class="property-category">${e.category}</div>`:e.value&&(a+=`<div class="property">\n                    <div class="property-name">${e.name}</div>\n                    <div class="property-value">${e.value}</div>\n                </div>`);let s=`<div class="concime-detail">\n            <div class="concime-title">\n                <small>${i.type}</small>\n\n                <button class="concime-close" onclick="APP.hideConcime();">\n                    <img src="/img/icons/close-white.svg" alt="">\n                </button>\n            </div>\n            <div class="concime-scroll">\n                <div class="concime-img">\n                    <img src="/img/concime/${t}.png" alt="${i.name}" />\n                    <div class="concime-subtitle">\n                        ${i.name}\n                    </div>\n                </div>\n\n                <div class="property-list">\n                    ${a}\n                </div>\n            </div>\n        </div>`,r=document.createElement("div");return r.classList.add("concime-detail-container"),r.innerHTML=s,e.append(r),setTimeout(()=>{document.querySelector(".concime-detail-container").classList.add("is-visible")},300),null},n.hideConcime=function(){n.previousTemplate;let e=document.querySelector(".concime-detail-container");e&&(e.classList.remove("is-visible"),setTimeout(()=>{e.remove()},300))},n.initSetWorkingParameters=function(t){let i=n.getMachine(n.currentMachine),c="";i.widthOpt&&(c=`<div class="optional-width">\n                <input class="optional-width-checkbox switch" id="optionalWidth" name="optionalWidth" type="checkbox" onchange="APP.refreshMaxWorkingWidth();">\n                <label class="optional-width-label" for="optionalWidth">${LANG.get("working-optional-kit")}</label>\n            </div>`);let a={width:{min:i.widthMin,max:n.getMaxWidth(n.currentMachine,n.currentConcime)},speed:{min:6,max:20},quantity:{min:3,max:1e3}},s=t.querySelector(".parameter-list"),r="";for(const e of Object.keys(a)){let t=a[e];r+=`<div class="parameter parameter-${e}">\n                <div class="parameter-title">${UTIL.capitalizeFirstLetter(e)}</div>\n                ${"width"===e?c:""}\n                <div class="parameter-input">\n                    <div class="parameter-text">\n                        <input id="widthText" type="text" value="${t.min}">\n                    </div>\n                    <div class="parameter-slider">\n                        <div class="parameter-max">${t.max}m</div>\n                        <div class="parameter-min">${t.min}m</div>\n                        <input id="widthRange" type="range" step="1" max="${t.max}" min="${t.min}" value="${t.min}" oninput="APP.refreshCheckLabel(this);">\n                    </div>\n                </div>\n\n\n            </div>`}return s.innerHTML=r,e.innerHTML=n.getStepHtml("params"),t.innerHTML=r,e.append(t),null},n.refreshCheckLabel=function(e){let t=e.closest(".parameter").querySelector(".parameter-text input");console.log(e.value),t.value=e.value},n.refreshMaxWorkingWidth=function(){n.getMachine(n.currentMachine);let e=document.querySelector(".optional-width-checkbox"),t=document.querySelector(".parameter-width .parameter-max"),i=document.querySelector(".parameter-width .parameter-slider input"),c=n.getMaxWidth(n.currentMachine,n.currentConcime,e.checked);t.innerHTML=c+"m",i.setAttribute("max",c),n.refreshCheckLabel(i)},n.paramsReset=function(){},n.paramsCompute=function(){n.currentWorkingWidth=document.querySelector(".parameter-width .parameter-slider input").value,n.currentWorkingSpeed=document.querySelector(".parameter-speed .parameter-slider input").value,n.currentWorkingQuantity=document.querySelector(".parameter-quantity .parameter-slider input").value,n.changeContent("result")},n.getMaxWidth=function(e,t,i=!1){let c=n.getMachine(e),a=n.getConcime(t),s=Math.min(c.widthMax,a.spreadingLimit),r=i?c.widthOptException:c.widthException;return r&&t in r&&(s=Math.min(s,r[t])),s},n.getOpening=function(e,t){const i=0,c=1;n.getMachine(e),n.getConcime(t);let a=n.currentWorkingQuantity*n.currentWorkingWidth*n.currentWorkingSpeed/600;a=UTIL.round(a);let s=null,r=CURVE_DATA[t],l=Number.MAX_VALUE,o=null;for(let e=0;e<r.length&&(o=Math.abs(r[e][c]-a),o<l);e++)l=o,s=r[e][i];return{opening:s,kgMin:a}},n.initResult=function(t){function i(e,t){let n=`<div class="result">\n                <div class="result-text">${e}</div>\n                <div class="result-line"></div>\n                <div class="result-value">${t}</div>\n            </div>`;return n}let c=n.getMachine(n.currentMachine),a=n.getConcime(n.currentConcime),s=t.querySelector(".result-list"),r="",l=n.getOpening(n.currentMachine,n.currentConcime);return r+=i("openening",l.opening),r+=i("kg/min",l.kgMin),r+='<div class="result-separator"></div>',r+=i("spreader",c.name),r+=i("discs height",""),r+=i("pto speed",""),r+='<div class="result-separator"></div>',r+=i("family",a.type),r+=i("product",a.name),r+=i("form",a.shape),r+=i("weight",a.weight),r+='<div class="result-separator"></div>',r+=i("working width",n.currentWorkingWidth),r+=i("speed",n.currentWorkingSpeed),r+=i("quantity",n.currentWorkingQuantity),s.innerHTML=r,e.innerHTML=n.getStepHtml("result"),e.append(t),null},n.saveResult=function(){},n.getResultList=function(){},n.getFlowStepHtml=function(e){let t="",i="is-selected",c=!n.currentConcime||!n.currentMachine;return t=`<div class="step-list">\n            <button class="step ${"machine"===e?i:""}" data-step="machine" onclick="APP.changeContent('set-machine');">\n                <div class="step-number">1</div>\n                <div class="step-title">${LANG.get("step-machine")}</div>\n                <div class="step-subtitle">Set your spreader</div>\n            </button>\n            <button class="step ${c?"is-disabled":""} ${"params"===e?i:""}" data-step="params" onclick="APP.changeContent('set-params');">\n                <div class="step-number">2</div>\n                <div class="step-title">${LANG.get("step-params")}</div>\n                <div class="step-subtitle">Set parameters</div>\n            </button>\n            <button class="step ${c?"is-disabled":""} ${"result"===e?i:""}" data-step="result" onclick="APP.changeContent('result');">\n                <div class="step-number">3</div>\n                <div class="step-title">RESULT</div>\n                <div class="step-subtitle"> </div>\n            </button>\n        </div>`,t},n.initFlowFactor=function(t){return e.innerHTML=n.getFlowStepHtml("machine"),e.append(t),null},n}();document.addEventListener("DOMContentLoaded",function(){LANG.init()});