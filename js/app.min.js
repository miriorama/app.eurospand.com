"use strict";var UTIL=function(){let e={capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},round:function(e){return Math.round(100*(e+Number.EPSILON))/100},guid:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))},formatDate:function(e){let t=new Date(e),n=t.getFullYear(),i=t.getMonth()+1,a=t.getDate();return a<10&&(a="0"+a),i<10&&(i="0"+i),`${n}-${i}-${a}`}};return e}(),LANG=function(){let e={data:null,_current:null,keys:["es","bu","de","en","fr","gr","hu","it","nl","pt","ro","ru","tr"]};const t="eurospandLang";return e.init=function(n){let i={lang:null};n=Object.assign({},i,n);let a=document.querySelector("[data-lang]");if(a&&a.remove(),!n.lang){let e=localStorage.getItem(t);e&&(n.lang=e)}n.lang||(n.lang=LANG.detect()),n.lang||(n.lang="en");let c="lang/"+n.lang+".js",r=document.createElement("script");r.setAttribute("data-lang",n.lang),r.onload=function(){e.data=LANG_DATA,UNIT.init(),APP.init()},r.src=c,document.head.appendChild(r),e._current=n.lang,localStorage.setItem(t,e.current())},e.current=function(){return e._current},e.get=function(t){return e.data[t]},e.list=function(){return[{id:"it",name:"italiano"},{id:"en",name:"english"},{id:"fr",name:"Français"},{id:"de",name:"Deutsch"},{id:"nl",name:"Nederlands"},{id:"es",name:" español"},{id:"ru",name:"Pусский"},{id:"gr",name:"ελληνικά"},{id:"pt",name:"Português"},{id:"ro",name:"Română"},{id:"tr",name:"Türk"},{id:"bu",name:"български"},{id:"hu",name:"Magyar"}]},e.change=function(e){return!1},e.detect=function(){let e=null;try{e=navigator.language.substring(0,2)}catch(t){e=null}return e},e.replace=function(e){console.log(typeof e);let t="";if("string"!=typeof e){let n=document.createElement("div");n.append(e),t=n.innerHTML,console.log(t)}return t=String(t).replace(/\{(.*?)\}/g,function(e,t){return LANG.get(t)}),t},e}(),UNIT=function(){let e={data:null,_current:null,WIDTH:"width",SPEED:"speed",QUANTITY:"quantity",MASS_FLOW:"massFlow"};const t="eurospandUnit";e.init=function(n){let i={unit:null};if(n=Object.assign({},i,n),!n.unit){let e=localStorage.getItem(t);e&&(n.unit=e)}n.unit||(n.unit="m"),e._current=e.get(n.unit),localStorage.setItem(t,e.current().id)},e.current=function(){return e._current},e.get=function(t){for(const n of e.list())if(n.id==t)return n;return null},e.list=function(){return[{id:"m",width:"m",speed:"Km/h",quantity:"Kg/ha",massFlow:"Kg/min"},{id:"b",width:"ft",speed:"mph",quantity:"lb/ac",massFlow:"lb/min"},{id:"a",width:"ft",speed:"mph",quantity:"lb/ac",massFlow:"lb/min"}]},e.change=function(t){e.init({unit:t})};const n={width:3.281,speed:.621,quantity:.892,massFlow:2.205};return e.convert=function(t,i,a=!1){let c;return"m"==e.current().id?t:(c=t*n[i],c=c.toFixed(2),a&&(c+=" "+UNIT.current()[i]),c)},e.unconvert=function(t,i){let a;return"m"==e.current().id?t:(a=t/n[i],a.toFixed(2))},e}(),API=function(){let e={};return e=function(e,t){function n(e){return new Promise(t=>e.json().then(n=>t({status:e.status,ok:e.ok,json:n})))}let i,a=!1;if(t instanceof FormData)i=t;else{a=!0;let e={};t=Object.assign({},e,t),i=JSON.stringify(t)}let c={method:"post",body:i};return a&&(c.headers={"content-type":"application/json"}),new Promise((t,i)=>{fetch(e,c).then(e=>(e.redirected&&(location.href=e.url),e)).then(n).then(e=>e.ok?t(e.json.content):i(e.json)).catch(e=>i({networkError:e.message}))})},e}(),APP=function(){let e={debug:!1,currentMachine:null,currentConcime:null,concimeTypeList:["fertilizzanti","semi","lumachicida"]};const t="eurospandSavedWorks";let n,i,a,c,r,s;return e.init=function(){n=document.querySelector("body"),i=document.querySelector(".main"),a=document.querySelector(".menu"),c=document.querySelector(".title"),r=c.querySelector(".title .red"),s=c.querySelector(".title .gray"),e.debug&&(e.currentMachine="david-compact",e.currentConcime="mesurol-pro",e.currentWorkingWidth=9,e.currentWorkingSpeed=6,e.currentWorkingQuantity=1),e.routes=[{regex:"^$",template:"index",callback:e.initIndex},{regex:"^set-machine/?$",template:"set-machine",callback:e.initSetMachine},{regex:"^machine/(?<id>[^/]*)/?$",template:"machine-detail",callback:e.initMachine,animate:!1},{regex:"^set-concime/?$",template:"set-concime",callback:e.initSetConcime},{regex:"^set-params/?$",template:"set-params",callback:e.initSetWorkingParameters},{regex:"^result/?$",template:"result",callback:e.initResult},{regex:"^flow-factor/?$",template:"flow-factor",callback:e.initFlowFactor},{regex:"^saved-works/?$",template:"saved-works",callback:e.initSavedWorks},{regex:"^set-language/?$",template:"set-language",callback:e.initSetLanguage},{regex:"^set-unit/?$",template:"set-unit",callback:e.initSetUnit}],window.addEventListener("hashchange",APP.onHashChange,!1),APP.onHashChange(),e.initMenu()},e.onHashChange=function(){e.hash=location.hash.substring(1);let t=!0,n=200;for(const c of e.routes){let r=new RegExp(c.regex,"i"),s=e.hash.match(r);if(s){let r=s.groups,l=document.querySelector(`template[data-section=${c.template}]`);if(l){e.currentTemplate&&(e.previousTemplate=e.currentTemplate),e.currentTemplate=c.template,e.currentTemplate;let s=l.content.cloneNode(!0);function a(){function e(){document.body.classList.add("animate")}let a=null;a="function"==typeof c.callback?c.callback(s,r):s,a&&(i.innerHTML="",i.append(a)),t?window.setTimeout(function(){e()},n):e()}t&&(document.body.classList.remove("animate"),e.previousTemplate?setTimeout(function(){a()},n):a())}break}}window.scrollTo({top:0,behavior:"smooth"})},e.changeContent=function(e){location.hash=e},e.back=function(e){history.back()},e.initIndex=function(t){return i.innerHTML=LANG.replace(t),e.setTitle(),null},e.setTitle=function(e=null,t=null){r&&(r.innerHTML=e||""),s&&(s.innerHTML=t||""),e||t?c.classList.remove("is-hidden"):c.classList.add("is-hidden")},e.initMenu=function(){let e=a.querySelector(".menu-saved"),t=a.querySelector(".menu-lang"),n=a.querySelector(".menu-unit"),i=a.querySelector(".menu-who"),c=a.querySelector(".menu-contact");e.innerHTML=LANG.get("menu-saved"),t.innerHTML=LANG.get("menu-lang"),n.innerHTML=LANG.get("menu-unit"),i.innerHTML=LANG.get("menu-who"),c.innerHTML=LANG.get("menu-contact")},e.menuOpen=function(){a.classList.add("is-visible"),n.classList.add("is-overflow")},e.menuClose=function(){a.classList.remove("is-visible"),n.classList.remove("is-overflow")},e.getStepHtml=function(t){let n=document.createElement("div");n.classList.add("step-list");let i=`<div class="step-list">\n            <button class="step" data-step="machine" onclick="APP.changeContent('set-machine');">\n                <div class="step-number">1</div>\n                <div class="step-title">${LANG.get("step-machine")}</div>\n                <div class="step-img">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-funnel" viewBox="0 0 16 16"><path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2h-11z"/></svg>\n                </div>\n                <div class="step-subtitle">${LANG.get("step-machine")}</div>\n            </button>\n            <button class="step" data-step="concime" onclick="APP.changeContent('set-concime');">\n                <div class="step-number">2</div>\n                <div class="step-title">${LANG.get("step-product")}</div>\n                <div class="step-img">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-flower2" viewBox="0 0 16 16"><path d="M8 16a4 4 0 0 0 4-4 4 4 0 0 0 0-8 4 4 0 0 0-8 0 4 4 0 1 0 0 8 4 4 0 0 0 4 4zm3-12c0 .073-.01.155-.03.247-.544.241-1.091.638-1.598 1.084A2.987 2.987 0 0 0 8 5c-.494 0-.96.12-1.372.331-.507-.446-1.054-.843-1.597-1.084A1.117 1.117 0 0 1 5 4a3 3 0 0 1 6 0zm-.812 6.052A2.99 2.99 0 0 0 11 8a2.99 2.99 0 0 0-.812-2.052c.215-.18.432-.346.647-.487C11.34 5.131 11.732 5 12 5a3 3 0 1 1 0 6c-.268 0-.66-.13-1.165-.461a6.833 6.833 0 0 1-.647-.487zm-3.56.617a3.001 3.001 0 0 0 2.744 0c.507.446 1.054.842 1.598 1.084.02.091.03.174.03.247a3 3 0 1 1-6 0c0-.073.01-.155.03-.247.544-.242 1.091-.638 1.598-1.084zm-.816-4.721A2.99 2.99 0 0 0 5 8c0 .794.308 1.516.812 2.052a6.83 6.83 0 0 1-.647.487C4.66 10.869 4.268 11 4 11a3 3 0 0 1 0-6c.268 0 .66.13 1.165.461.215.141.432.306.647.487zM8 9a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/></svg>\n                </div>\n                <div class="step-subtitle">${LANG.get("step-product")}</div>\n            </button>\n            <button class="step" data-step="params" onclick="APP.changeContent('set-params');">\n                <div class="step-number">3</div>\n                <div class="step-title">${LANG.get("step-params")}</div>\n                <div class="step-img">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sliders" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.5 2a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM9.05 3a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0V3h9.05zM4.5 7a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM2.05 8a2.5 2.5 0 0 1 4.9 0H16v1H6.95a2.5 2.5 0 0 1-4.9 0H0V8h2.05zm9.45 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm-2.45 1a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0v-1h9.05z"/></svg>\n                </div>\n                <div class="step-subtitle">${LANG.get("step-params")}</div>\n            </button>\n            <button class="step" data-step="result" onclick="APP.changeContent('result');">\n                <div class="step-number">4</div>\n                <div class="step-title">${LANG.get("step-result")}</div>\n                <div class="step-img">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list-check" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3.854 2.146a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 3.293l1.146-1.147a.5.5 0 0 1 .708 0zm0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 7.293l1.146-1.147a.5.5 0 0 1 .708 0zm0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0z"/></svg>\n                </div>\n                <div class="step-subtitle">${LANG.get("step-result")}</div>\n            </button>\n        </div>`;n.innerHTML=i;let a=n.querySelector(`[data-step=${t}]`);a.classList.add("is-selected");let c=!e.currentConcime||!e.currentMachine,r=n.querySelector("[data-step=params]"),s=n.querySelector("[data-step=result]");if(c?(r.classList.add("is-disabled"),s.classList.add("is-disabled")):(r.classList.remove("is-disabled"),s.classList.remove("is-disabled")),e.currentMachine){let t=n.querySelector("[data-step=machine]");t.classList.add("is-set");let i=n.querySelector("[data-step=machine] .step-subtitle");i.innerHTML=e.getMachine(e.currentMachine).name}if(e.currentConcime){let t=n.querySelector("[data-step=concime]");t.classList.add("is-set");let i=n.querySelector("[data-step=concime] .step-subtitle");i.innerHTML=e.getConcime(e.currentConcime).name}if(e.currentWorkingWidth&&e.currentWorkingSpeed&&e.currentWorkingQuantity){let e=n.querySelector("[data-step=params]");e.classList.add("is-set")}return n.innerHTML},e.initSetMachine=function(t){let n=t.querySelector(".machine-list"),a=e.getMachine(),c="";for(const e of Object.keys(a)){let t=a[e];c+=`<button class="machine" onclick="APP.setMachine('${e}');">\n                <div class="machine-img">\n                    <img src="img/machine/${e}.jpg" alt="${t.name}" />\n                </div>\n                <div class="machine-footer">\n\n                    <div class="machine-info" onclick="event.stopPropagation();APP.showMachine('${e}');">\n                        <img src="img/icons/info-white.svg" />\n                    </div>\n                        <div class="machine-title">\n                            <div>\n                            ${t.name}\n                            <small>${t.subtitle}</small>\n                            </div>\n                        <img src="img/icons/chevron-right-white.svg" />\n                    </div>\n                </div>\n            </button>`}return e.setTitle(LANG.get("opening-calculate"),LANG.get("step-machine")),n.innerHTML=c,i.innerHTML=e.getStepHtml("machine"),i.append(t),null},e.getMachine=function(e){return e?MACHINE_DATA[e]:MACHINE_DATA},e.setMachine=function(t){t&&(e.currentMachine=t,e.refreshStepList(),e.currentConcime?e.changeContent("set-params"):e.changeContent("set-concime"))},e.initMachine=function(t,n){let a=e.getMachine(n.id),c="machine-desc",r=`<div class="machine-detail">\n            <button class="machine-close" onclick="APP.hideMachine();">\n                <img src="img/icons/close.svg" alt="">\n            </button>\n            <div class="machine-img">\n                <img src="img/machine/${n.id}.jpg" alt="${a.name}" />\n            </div>\n            <div class="machine-title">\n                ${a.name}\n            </div>\n            <div class="machine-subtitle">\n                ${a.subtitle}\n                </div>\n            <div class="machine-desc">${c}</div>\n        </div>`,s=document.createElement("div");return s.classList.add("machine-detail-container","is-visible"),s.innerHTML=r,i.append(s),null},e.showMachine=function(t){let n=e.getMachine(t),a=LANG.get(t),c=`<div class="machine-detail">\n            <div class="machine-title">\n                ${n.name}\n                <small>${n.subtitle}</small>\n\n                <button class="machine-close" onclick="APP.hideMachine();">\n                    <img src="img/icons/close-white.svg" alt="">\n                </button>\n            </div>\n            <div class="machine-scroll">\n                <div class="machine-img">\n                    <img src="img/machine/${t}.jpg" alt="${n.name}" />\n                    <div class="machine-subtitle">\n                        ${a.subtitle}\n                    </div>\n                </div>\n\n                <div class="machine-desc">\n                    <b>${a.shortDescription}</b>\n                    ${a.description}\n                </div>\n            </div>\n        </div>`,r=document.createElement("div");return r.classList.add("machine-detail-container"),r.innerHTML=c,i.append(r),setTimeout(()=>{document.querySelector(".machine-detail-container").classList.add("is-visible")},300),null},e.hideMachine=function(){e.previousTemplate;let t=document.querySelector(".machine-detail-container");t&&(t.classList.remove("is-visible"),setTimeout(()=>{t.remove()},300))},e.initSetConcime=function(t){let n=t.querySelector(".concime-type-list"),a=t.querySelector(".concime-list"),c=e.getConcime(),r='<div class="concime-type-title">Filter by:</div>';for(const t of e.concimeTypeList){let e=UTIL.capitalizeFirstLetter(t);r+=`<button class="concime-type" onclick="APP.setConcimeType(this, '${t}');">\n                <div class="concime-type-img">\n                    <img src="img/concime-type/${t}.jpg" alt="${e}" />\n                </div>\n                ${e}\n            </button>`}n.innerHTML=r,r="";for(const e of Object.keys(c)){let t=c[e];r+=`<button class="concime" data-concime-type="${t.type}" onclick="APP.setConcime('${e}');">\n                <div class="concime-img">\n                    <img src="img/concime/${e}.png" alt="${t.name}" />\n                </div>\n                <div class="concime-footer">\n                    <div class="concime-info" onclick="event.stopPropagation();APP.showConcime('${e}');">\n                        <img src="img/icons/info-white.svg" />\n                    </div>\n                    <div class="concime-title">\n                        <div>${t.name}</div>\n                        <img src="img/icons/chevron-right-white.svg" />\n                    </div>\n                </div>\n            </button>`}return a.innerHTML=r,i.innerHTML=e.getStepHtml("concime"),i.append(t),e.setTitle(LANG.get("opening-calculate"),LANG.get("step-product")),null},e.getConcime=function(e){return e?CONCIME_DATA[e]:CONCIME_DATA},e.setConcimeType=function(e,t){let n=document.querySelector(".concime-type.is-selected");if(n&&n.classList.remove("is-selected"),e.classList.add("is-selected"),!t)return;let i=document.querySelectorAll(".concime");for(const e of i)e.getAttribute("data-concime-type")===t?e.removeAttribute("hidden"):e.setAttribute("hidden","")},e.setConcime=function(t){t&&(e.currentConcime=t,e.refreshStepList(),e.changeContent("set-params"),e.currentMachine?e.changeContent("set-params"):e.changeContent("set-machine"))},e.refreshStepList=function(){if(e.currentConcime&&e.currentMachine){let e=document.querySelector(".step[data-step=params]");e.classList.remove("is-disabled")}},e.showConcime=function(t){let n=e.getConcime(t),a=(LANG.get(t),[{category:"Information"},{name:"Family",value:n.category||""},{name:"Country",value:n.country||""},{name:"Form",value:n.producer||""},{name:"Manufacturer",value:n.producer||""},{name:"KG/DM3",value:n.weight||""},{category:"Fractionation"},{name:"",value:""},{name:"",value:""},{category:"Chemical composition"},{name:"",value:n.chemicalComposition_it||""}]),c="";for(const e of a)e.category?c+=`<div class="property-category">${e.category}</div>`:e.value&&(c+=`<div class="property">\n                    <div class="property-name">${e.name}</div>\n                    <div class="property-line"></div>\n                    <div class="property-value">${e.value}</div>\n                </div>`);let r=`<div class="concime-detail">\n            <div class="concime-title">\n                <small>${n.type}</small>\n\n                <button class="concime-close" onclick="APP.hideConcime();">\n                    <img src="img/icons/close-white.svg" alt="">\n                </button>\n            </div>\n            <div class="concime-scroll">\n                <div class="concime-img">\n                    <img src="img/concime/${t}.png" alt="${n.name}" />\n                    <div class="concime-subtitle">\n                        ${n.name}\n                    </div>\n                </div>\n\n                <div class="property-list">\n                    ${c}\n                </div>\n            </div>\n        </div>`,s=document.createElement("div");return s.classList.add("concime-detail-container"),s.innerHTML=r,i.append(s),setTimeout(()=>{document.querySelector(".concime-detail-container").classList.add("is-visible")},300),null},e.hideConcime=function(){e.previousTemplate;let t=document.querySelector(".concime-detail-container");t&&(t.classList.remove("is-visible"),setTimeout(()=>{t.remove()},300))},e.initSetWorkingParameters=function(t){e.currentMachine||e.changeContent("set-machine"),e.currentConcime||e.changeContent("set-concime");let n=e.getMachine(e.currentMachine),a="";n.widthOpt&&(a=`<div class="optional-width">\n                <input class="optional-width-checkbox switch" id="optionalWidth" name="optionalWidth" type="checkbox" onchange="APP.refreshMaxWorkingWidth();">\n                <label class="optional-width-label" for="optionalWidth">${LANG.get("machine-kit")}</label>\n            </div>`);let c={width:{min:UNIT.convert(n.widthMin,UNIT.WIDTH),max:UNIT.convert(e.getMaxWidth(e.currentMachine,e.currentConcime),UNIT.WIDTH),unit:UNIT.current().width,current:UNIT.convert(e.currentWorkingWidth,UNIT.WIDTH)},speed:{min:UNIT.convert(6,UNIT.SPEED),max:UNIT.convert(20,UNIT.SPEED),unit:UNIT.current().speed,current:UNIT.convert(e.currentWorkingSpeed,UNIT.SPEED)},quantity:{min:UNIT.convert(3,UNIT.QUANTITY),max:UNIT.convert(1e3,UNIT.QUANTITY),unit:UNIT.current().quantity,current:UNIT.convert(e.currentWorkingQuantity,UNIT.QUANTITY)}},r=t.querySelector(".parameter-list"),s="";for(const e of Object.keys(c)){let t=c[e],n=t.current||t.min;s+=`<div class="parameter parameter-${e}" data-id="${e}">\n                <div class="parameter-title">${UTIL.capitalizeFirstLetter(e)}</div>\n                ${"width"===e?a:""}\n                <div class="parameter-input">\n                    <div class="parameter-text">\n                        <input id="widthText" type="text" value="${n}" onchange="APP.refreshCurrentParams(this);">\n                    </div>\n                    <div class="parameter-slider">\n                        <div class="parameter-max">${t.max} ${t.unit}</div>\n                        <div class="parameter-min">${t.min} ${t.unit}</div>\n                        <input id="widthRange" type="range" step="1" max="${t.max}" min="${t.min}" value="${n}" oninput="APP.refreshCheckLabel(this);">\n                    </div>\n                </div>\n\n\n            </div>`}return r.innerHTML=s,i.innerHTML=e.getStepHtml("params"),t.innerHTML=s,i.append(t),e.currentWorkingWidth=UNIT.unconvert(document.querySelector(".parameter-width .parameter-slider input").value,UNIT.WIDTH),e.currentWorkingSpeed=UNIT.unconvert(document.querySelector(".parameter-speed .parameter-slider input").value,UNIT.SPEED),e.currentWorkingQuantity=UNIT.unconvert(document.querySelector(".parameter-quantity .parameter-slider input").value,UNIT.QUANTITY),e.setTitle(LANG.get("opening-calculate"),LANG.get("step-params")),null},e.refreshCheckLabel=function(t){let n=t.closest(".parameter"),i=n.querySelector(".parameter-text input"),a=n.getAttribute("data-id");e["currentWorking"+UTIL.capitalizeFirstLetter(a)]=UNIT.unconvert(t.value,a),i.value=t.value},e.refreshMaxWorkingWidth=function(){e.getMachine(e.currentMachine);let t=document.querySelector(".optional-width-checkbox"),n=document.querySelector(".parameter-width .parameter-max"),i=document.querySelector(".parameter-width .parameter-slider input"),a=e.getMaxWidth(e.currentMachine,e.currentConcime,t.checked);a=UNIT.convert(a,UNIT.WIDTH),n.innerHTML=a+" "+UNIT.current().width,i.setAttribute("max",a),e.refreshCheckLabel(i)},e.paramsReset=function(){},e.refreshCurrentParams=function(t){let n=t.closest(".parameter"),i=n.getAttribute("data-id");e["currentWorking"+UTIL.capitalizeFirstLetter(i)]=UNIT.unconvert(t.value,i)},e.paramsCompute=function(){e.changeContent("result")},e.getMaxWidth=function(t,n,i=!1){let a=e.getMachine(t),c=e.getConcime(n),r=Math.min(a.widthMax,c.spreadingLimit),s=i?a.widthOptException:a.widthException;return s&&n in s&&(r=Math.min(r,s[n])),r},e.getOpening=function(t,n){const i=0,a=1;e.getMachine(t),e.getConcime(n);let c=e.currentWorkingQuantity*e.currentWorkingWidth*e.currentWorkingSpeed/600;c=UTIL.round(c);let r=null,s=CURVE_DATA[n],l=Number.MAX_VALUE,o=null;for(let e=0;e<s.length&&(o=Math.abs(s[e][a]-c),o<l);e++)l=o,r=s[e][i];return{opening:r,kgMin:c}},e.initResult=function(t){function n(e,t,n=!1,i=!1){let a="";return a+=n?`<div class="property-category">${e}</div>`:`<div class="property ${i?"is-important":""}">\n                    <div class="property-name">${e}</div>\n                    <div class="property-line"></div>\n                    <div class="property-value">${t}</div>\n                </div>`,a}e.currentMachine||e.changeContent("set-machine"),e.currentConcime||e.changeContent("set-concime");let a=e.getMachine(e.currentMachine),c=e.getConcime(e.currentConcime),r=t.querySelector(".result-list"),s="",l=e.getOpening(e.currentMachine,e.currentConcime);return s+=n(LANG.get("step-result"),a.name,!0),s+=n(LANG.get("opening"),l.opening,!1,!0),s+=n("Mass flow",UNIT.convert(l.kgMin,UNIT.MASS_FLOW,!0)),s+=n("Spreader",a.name,!0),s+=n("Spreader",a.name),s+=n("Discs height",""),s+=n("Pto speed",""),s+=n("Concime",a.name,!0),s+=n("Family",c.type),s+=n("Product",c.name),s+=n("Form",c.shape),s+=n("Weight",c.weight),s+=n("Working parameters",a.name,!0),s+=n("Working width",UNIT.convert(e.currentWorkingWidth,UNIT.WIDTH,!0)),s+=n("Speed",UNIT.convert(e.currentWorkingSpeed,UNIT.SPEED,!0)),s+=n("Quantity",UNIT.convert(e.currentWorkingQuantity,UNIT.QUANTITY,!0)),r.innerHTML='<div class="property-list">'+s+"</div>",i.innerHTML=e.getStepHtml("result"),i.append(t),e.setTitle(LANG.get("opening-calculate"),LANG.get("step-result")),null},e.saveResult=function(){let n={currentMachine:e.currentMachine,currentConcime:e.currentConcime,currentWorkingWidth:e.currentWorkingWidth,currentWorkingSpeed:e.currentWorkingSpeed,currentWorkingQuantity:e.currentWorkingQuantity,date:(new Date).toISOString(),id:UTIL.guid()},i=e.getSavedWorks();i.unshift(n),localStorage.setItem(t,JSON.stringify(i)),e.changeContent("saved-works")},e.getSavedWorks=function(){let e=JSON.parse(localStorage.getItem(t));return Array.isArray(e)||(e=[]),e},e.initSavedWorks=function(){let t="",n=document.createElement("div");n.classList.add("saved-work-list");let i=e.getSavedWorks();for(const n of i){let i=encodeURIComponent(JSON.stringify(n)),a=UTIL.formatDate(n.date),c=e.getMachine(n.currentMachine),r=e.getConcime(n.currentConcime);t+=`\n                <div class="saved-work">\n                    <div class="saved-work-text">\n                        <div class="saved-work-title" onclick="APP.loadSavedWork('${i}');">\n                            ${a} / ${c.name} / ${r.name}\n                        </div>\n                        <div class="saved-work-subtitle">\n                            <em>${LANG.get("params-width")}</em>${n.currentWorkingWidth}\n                            <em>${LANG.get("params-speed")}</em>${n.currentWorkingSpeed}\n                            <em>${LANG.get("params-quantity")}</em>${n.currentWorkingQuantity}\n                        </div>\n                    </div>\n                    <div class="saved-work-cta">\n                        <div class="saved-work-delete" onclick="APP.deleteSavedWork('${n.id||0}');">\n                            <img src="img/icons/close-white.svg" />\n                        </div>\n                    </div>\n                </div>`}return n.innerHTML=t,e.setTitle(LANG.get("saved-works"),""),n},e.loadSavedWork=function(t){t=JSON.parse(decodeURIComponent(t)),e.currentMachine=t.currentMachine,e.currentConcime=t.currentConcime,e.currentWorkingWidth=t.currentWorkingWidth,e.currentWorkingSpeed=t.currentWorkingSpeed,e.currentWorkingQuantity=t.currentWorkingQuantity,e.changeContent("result")},e.deleteSavedWork=function(n){let i=e.getSavedWorks(),a=0;for(const e of i){if(e.id==n){i.splice(a,1);break}a++}localStorage.setItem(t,JSON.stringify(i)),location.reload()},e.getFlowStepHtml=function(t){let n="",i="is-selected",a=!e.currentConcime||!e.currentMachine;return n=`<div class="step-list">\n            <button class="step ${"machine"===t?i:""}" data-step="machine" onclick="APP.changeContent('set-machine');">\n                <div class="step-number">1</div>\n                <div class="step-title">${LANG.get("step-machine")}</div>\n                <div class="step-subtitle">Set your spreader</div>\n            </button>\n            <button class="step ${a?"is-disabled":""} ${"params"===t?i:""}" data-step="params" onclick="APP.changeContent('set-params');">\n                <div class="step-number">2</div>\n                <div class="step-title">${LANG.get("step-params")}</div>\n                <div class="step-subtitle">Set parameters</div>\n            </button>\n            <button class="step ${a?"is-disabled":""} ${"result"===t?i:""}" data-step="result" onclick="APP.changeContent('result');">\n                <div class="step-number">3</div>\n                <div class="step-title">RESULT</div>\n                <div class="step-subtitle"> </div>\n            </button>\n        </div>`,n},e.initFlowFactor=function(t){return i.innerHTML=e.getFlowStepHtml("machine"),i.append(t),null},e.initSetLanguage=function(){let t="",n=document.createElement("div");for(const e of LANG.list()){let n=e.id==LANG.current()?"is-current":"";t+=`\n                    <div class="lang ${n}" onclick="LANG.change('${e.id}');APP.changeContent('')">\n                        <div class="lang-flag"><img src="img/lang/flag-${e.id}.png" /></div>\n                        <div class="lang-title">${e.name}</div>\n                    </div>`}return t=`<div class="lang-list">${t}</div>`,n.innerHTML=t,e.setTitle(LANG.get("menu-lang")),n},e.initSetUnit=function(){let t="",n=document.createElement("div");n.classList.add("unit-list");for(const e of UNIT.list()){let n=e.id==UNIT.current().id?"is-current":"";t+=`\n                    <div class="unit ${n}" onclick="UNIT.change('${e.id}');APP.back()">\n                        <div class="unit-title">${LANG.get("unit-system-"+e.id)}</div>\n                    </div>`}return n.innerHTML=t,e.setTitle(LANG.get("menu-unit")),n},e}();document.addEventListener("DOMContentLoaded",function(){LANG.init()});