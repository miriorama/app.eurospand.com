"use strict";var UTIL=function(){let e={capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}};return e}(),LANG=function(){let e={data:null,_current:null,keys:["es","bu","de","en","fr","gr","hu","it","nl","pt","ro","ru","tr"],init:function(t){let n={lang:"en"};t=Object.assign({},n,t);let i="/lang/"+t.lang+".js",c=document.createElement("script");c.onload=function(){e.data=LANG_DATA,APP.init()},c.src=i,document.head.appendChild(c),e._current=t.lang},current:function(){return e._current},get:function(t){return e.data[t]}};return e}(),API=function(){let e={};return e=function(e,t){function n(e){return new Promise(t=>e.json().then(n=>t({status:e.status,ok:e.ok,json:n})))}let i,c=!1;if(t instanceof FormData)i=t;else{c=!0;let e={};t=Object.assign({},e,t),i=JSON.stringify(t)}let r={method:"post",body:i};return c&&(r.headers={"content-type":"application/json"}),new Promise((t,i)=>{fetch(e,r).then(e=>(e.redirected&&(location.href=e.url),e)).then(n).then(e=>e.ok?t(e.json.content):i(e.json)).catch(e=>i({networkError:e.message}))})},e}(),APP=function(){let e,t={debug:!0,currentMachine:null,currentConcime:null,concimeTypeList:["fertilizzanti","semi","lumachicida"]};return t.init=function(){console.log("init"),e=document.querySelector(".main"),t.debug&&(t.currentMachine="david-compact",t.currentConcime="urea-granulare-46"),t.routes=[{regex:"^$",template:"index",callback:t.initIndex},{regex:"^select-machine/?$",template:"select-machine",callback:t.initSelectMachine},{regex:"^select-concime/?$",template:"select-concime",callback:t.initSelectConcime},{regex:"^set-working-parameters/?$",template:"set-working-parameters",callback:t.initSetWorkingParameters}],window.addEventListener("hashchange",APP.onHashChange,!1),APP.onHashChange()},t.onHashChange=function(){t.hash=location.hash.substring(1);let n=!0;for(const c of t.routes){let r=new RegExp(c.regex,"i"),a=t.hash.match(r);if(a){let r=a.groups,o=document.querySelector(`template[data-section=${c.template}]`);if(o){t.currentTemplate&&(t.previousTemplate=t.currentTemplate),t.currentTemplate=c.template;let a=o.content.cloneNode(!0);function i(){function t(){document.body.classList.add("animate")}let i=null;i="function"==typeof c.callback?c.callback(a,r):a,i&&(e.innerHTML="",e.append(i)),n?window.setTimeout(function(){t()},300):t()}n&&(document.body.classList.remove("animate"),t.previousTemplate?setTimeout(function(){i()},300):i())}break}}},t.changeContent=function(e){location.hash=e},t.initIndex=function(t){return console.log("test"),e.innerHTML="",e.append(t),null},t.initSelectMachine=function(n){let i=n.querySelector(".machine-list"),c=t.getMachine(),r="";for(const e of Object.keys(c)){let t=c[e];r+=`<div class="machine">\n                <div class="machine-img">\n                    <img src="/img/machine/${e}.jpg" alt="${t.name}" />\n                    <button onclick="APP.setMachine(${e});">${LANG.get("select")}</button>\n                </div>\n                ${t.name}\n            </div>`}return i.innerHTML=r,e.innerHTML="",e.append(n),null},t.getMachine=function(e){return e?MACHINE_DATA[e]:MACHINE_DATA},t.setMachine=function(e){e&&(t.currentMachine=e,t.changeContent("select-concime"))},t.initSelectConcime=function(n){let i=n.querySelector(".concime-type-list"),c=n.querySelector(".concime-list"),r=t.getConcime(),a="";for(const e of t.concimeTypeList){let t=UTIL.capitalizeFirstLetter(e);a+=`<div class="concime-type">\n                <div class="concime-type-img">\n                    <img src="/img/concime-type/${e}.png" alt="${t}" />\n                    <button onclick="APP.setConcimeType('${e}');">${LANG.get("select")}</button>\n                </div>\n                ${t}\n            </div>`}i.innerHTML=a,a="";for(const e of Object.keys(r)){let t=r[e];a+=`<div class="concime" data-concime-type="${t.type}" hidden>\n                <div class="concime-img">\n                    <img src="/img/concime/${e}.png" alt="${t.name}" />\n                    <button onclick="APP.setConcime('${e}');">${LANG.get("select")}</button>\n                </div>\n                ${t.name}\n            </div>`}return c.innerHTML=a,e.innerHTML="",e.append(n),null},t.getConcime=function(e){return e?CONCIME_DATA[e]:CONCIME_DATA},t.setConcimeType=function(e){if(!e)return;let t=document.querySelectorAll(".concime");for(const n of t)n.getAttribute("data-concime-type")===e?n.removeAttribute("hidden"):n.setAttribute("hidden","")},t.setConcime=function(e){e&&(t.currentConcime=e,t.changeContent("set-working-parameters"))},t.initSetWorkingParameters=function(n){let i=t.getMachine(t.currentMachine),c={width:{min:i.widthMin,max:i.widthMax},speed:{min:6,max:20},quantity:{min:1,max:1e3}};for(const e of Object.keys(c)){let t=c[e],i=n.querySelector(".parameter-"+e+" .parameter-title"),r=n.querySelector(".parameter-"+e+" .parameter-slider"),a=n.querySelector(".parameter-"+e+" .parameter-max"),o=n.querySelector(".parameter-"+e+" .parameter-min");i.innerHTML=UTIL.capitalizeFirstLetter(e),o.innerHTML=t.min+"m",r.setAttribute("min",t.min),a.innerHTML=t.max+"m",r.setAttribute("max",t.max)}return e.innerHTML="",e.append(n),null},t.getLang=function(){},t}();document.addEventListener("DOMContentLoaded",function(){LANG.init()});